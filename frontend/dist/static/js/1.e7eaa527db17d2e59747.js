webpackJsonp([1],{"5PlU":function(e,t,n){var a=n("RY/4"),o=n("dSzd")("iterator"),s=n("/bQp");e.exports=n("FeBl").isIterable=function(e){var t=Object(e);return void 0!==t[o]||"@@iterator"in t||s.hasOwnProperty(a(t))}},BO1k:function(e,t,n){e.exports={default:n("fxRn"),__esModule:!0}},G5Mx:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n("mvHQ"),o=n.n(a),s=n("d7EF"),l=n.n(s),i=n("looZ"),r=n("n5Qe"),c={inject:["reload"],name:"settings",components:{Topbar:i.a},data:function(){return{diseases:["无","高血压","高血脂","冠心病","脑中风","支气管哮喘","慢性支气管炎","老年痴呆","其他"],blood_select:["A","B","AB","O","其他"],manInfo:this.getManInfo(),text1:"请输入手机号码",text2:"请输入手机号码",showContact2Delete:!1,showContact3Delete:!1,centerDialogVisible:!1,isModified:!1,phoneNumber1:"",phoneNumber2:"",phoneNumber3:""}},created:function(){document.title=this.$route.meta.title},mounted:function(){!!navigator.userAgent.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/)&&(window.onpageshow=function(e){(e.persisted||window.performance&&2===window.performance.navigation.type)&&window.location.reload()});var e=this;r.a.getInfo(sessionStorage.getItem("qrCodeId")).then(function(t){if(console.log("settings 获取info:",t.data),0===t.data.status_code){var n=t.data.data;e.manInfo.name=n.old_man_info.name,e.manInfo.age=n.old_man_info.age.toString(),e.manInfo.address=n.old_man_info.address,""===n.old_man_info.medical_history.trim()?e.manInfo.medical_history=[]:e.manInfo.medical_history=n.old_man_info.medical_history.split(","),e.manInfo.allergy=n.old_man_info.allergy,e.manInfo.blood_type=n.old_man_info.blood_type,e.manInfo.drugs=n.old_man_info.drugs,e.manInfo.treatment=n.old_man_info.treatment,e.manInfo.message=n.old_man_info.message,console.log("电话号码:",n.phone_number);var a=l()(n.phone_number,3),s=a[0],i=a[1],r=a[2];e.phoneNumber1=s,e.phoneNumber2=i,e.phoneNumber3=r,console.log("电话号码:",e.phoneNumber1,e.phoneNumber2,e.phoneNumber3),sessionStorage.setItem("manInfo",o()(e.manInfo))}})},methods:{generatePhoneStr:function(e){for(var t="",n=0;n<e.length;n++){t+=e[n]+","}return t=t.substr(0,t.length-1)},getleagalContact:function(e){for(var t=[],n=0,a=e,o=0;o<a.length;o++)null!==a[o]&&""!==a[o]&&void 0!==a[o]&&"undefined"!==a[o]&&(t[n]=a[o],n++);return t},getManInfo:function(){var e={name:"",address:"",age:"",medical_history:"",allergy:"",blood_type:"",drugs:"",treatment:"",message:""},t=sessionStorage.getItem("manInfo");if(null!==t&&void 0!==t&&""!==t&&"undefined"!==t){var n=JSON.parse(t);e.name=n.name,null!==n.age&&"null"!==n.age&&void 0!==n.age&&"undefined"!==n.age&&""!==n.age?e.age=n.age.toString():e.age="",e.address=n.address,n.medical_history instanceof Array?e.medical_history=n.medical_history:""===n.medical_history.trim()?e.medical_history=[]:e.medical_history=n.medical_history.split(","),e.allergy=n.allergy,e.blood_type=n.blood_type,e.drugs=n.drugs,e.treatment=n.treatment,e.message=n.message}return e},saveInfo:function(){var e=this;if(0===this.manInfo.name.length)return this.$toast("姓名不能为空!"),void window.location.reload();var t=sessionStorage.getItem("qrCodeId"),n=sessionStorage.getItem("UcallFreeId"),a=o()(this.manInfo),s=JSON.parse(a);s.age=parseInt(s.age),s.medical_history=s.medical_history.toString();var l=[this.phoneNumber1,this.phoneNumber2,this.phoneNumber3];sessionStorage.setItem("manInfo",o()(s)),r.a.saveInfo(t,n,s,l).then(function(n){0===n.data.status_code?0===sessionStorage.getItem("isQrCodeActive")||"0"===sessionStorage.getItem("isQrCodeActive")?r.a.activateQrCode(sessionStorage.getItem("openId"),t,sessionStorage.getItem("UcallFreeId")).then(function(t){0===t.data.Code?(e.$toast("激活二维码成功"),e.centerDialogVisible=!0,console.log("激活二维码成功:",t)):(e.$toast("激活二维码失败"),window.location.reload(),console.log("激活二维码失败1:",t))}).catch(function(t){e.$toast("激活二维码失败"),window.location.reload(),console.log("激活二维码失败2:",t)}):(e.$toast("保存信息成功"),console.log("保存信息成功:"),e.centerDialogVisible=!0):(e.$toast("保存信息失败"),console.log("保存信息失败1:"),window.location.reload())}).catch(function(t){console.log("保存信息失败2:",t),e.$toast("保存信息失败!"),window.location.reload(),e.centerDialogVisible=!1})},dialogConfirm:function(){this.centerDialogVisible=!1,window.scrollTo({top:0,left:0,behavior:"smooth"}),setTimeout(function(){window.location.reload()},500)}}},m={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",[n("Topbar",{staticClass:"topbar",attrs:{"show-save-btn":!0},on:{saveInfo:e.saveInfo}}),e._v(" "),n("el-row",{staticClass:"alert-row margin-horizontal"},[e._v("注意保存信息!")])],1),e._v(" "),e._m(0),e._v(" "),n("div",{staticClass:"contact-panel"},[n("el-row",{staticClass:"contact-item border-bottom"},[n("span",{staticClass:"contact-name"},[e._v("联系人1")]),e._v(" "),n("el-input",{staticClass:"contact-number",attrs:{placeholder:"请输入手机号码"},model:{value:e.phoneNumber1,callback:function(t){e.phoneNumber1=t},expression:"phoneNumber1"}})],1),e._v(" "),n("el-row",{staticClass:"contact-item border-bottom"},[n("span",{staticClass:"contact-name"},[e._v("联系人2")]),e._v(" "),n("el-input",{staticClass:"contact-number",attrs:{placeholder:"请输入手机号码"},model:{value:e.phoneNumber2,callback:function(t){e.phoneNumber2=t},expression:"phoneNumber2"}})],1),e._v(" "),n("el-row",{staticClass:"contact-item"},[n("span",{staticClass:"contact-name"},[e._v("联系人3")]),e._v(" "),n("el-input",{staticClass:"contact-number",attrs:{placeholder:"请输入手机号码"},model:{value:e.phoneNumber3,callback:function(t){e.phoneNumber3=t},expression:"phoneNumber3"}})],1)],1),e._v(" "),e._m(1),e._v(" "),n("div",{staticClass:"info-fill-panel leftpadding"},[n("el-row",{staticClass:"info-item border-bottom "},[n("span",{staticClass:"info-name"},[e._v("姓名*")]),e._v(" "),n("el-input",{staticClass:"info-content normal-input-style ",attrs:{maxlength:"10",placeholder:"预设内容(必填)",clearable:""},model:{value:e.manInfo.name,callback:function(t){e.$set(e.manInfo,"name",t)},expression:"manInfo.name"}})],1),e._v(" "),n("el-row",{staticClass:"info-item border-bottom "},[n("span",{staticClass:"info-name"},[e._v("地址")]),e._v(" "),n("el-input",{staticClass:"info-content normal-input-style ",attrs:{maxlength:"30",placeholder:"预设内容",clearable:""},model:{value:e.manInfo.address,callback:function(t){e.$set(e.manInfo,"address",t)},expression:"manInfo.address"}})],1)],1),e._v(" "),n("el-row",{staticClass:"info-item border-bottom leftpadding white-bg"},[n("span",{staticClass:"info-name"},[e._v("出生年份")]),e._v(" "),n("el-date-picker",{staticClass:"info-content normal-input-style ",attrs:{type:"year","default-value":"2020",format:"yyyy","value-format":"yyyy",placeholder:"请选择年份"},model:{value:e.manInfo.age,callback:function(t){e.$set(e.manInfo,"age",t)},expression:"manInfo.age"}})],1),e._v(" "),n("div",{staticClass:"info-fill-panel leftpadding"},[n("el-row",{staticClass:"info-item-height-wrap-content border-bottom"},[n("span",{staticClass:"info-name"},[e._v("病史")]),e._v(" "),n("el-select",{staticClass:"info-content normal-input-style ",attrs:{"allow-create":"",filterable:"",multiple:"",placeholder:"请输入病史"},model:{value:e.manInfo.medical_history,callback:function(t){e.$set(e.manInfo,"medical_history",t)},expression:"manInfo.medical_history"}},e._l(e.diseases,function(e){return n("el-option",{key:e,attrs:{label:e,value:e}})}),1)],1),e._v(" "),n("el-row",{staticClass:"info-item border-bottom"},[n("span",{staticClass:"info-name"},[e._v("过敏史")]),e._v(" "),n("el-input",{staticClass:"info-content normal-input-style ",attrs:{placeholder:"预设内容",clearable:""},model:{value:e.manInfo.allergy,callback:function(t){e.$set(e.manInfo,"allergy",t)},expression:"manInfo.allergy"}})],1)],1),e._v(" "),n("el-row",{staticClass:"info-item border-bottom leftpadding white-bg"},[n("span",{staticClass:"info-name"},[e._v("血型")]),e._v(" "),n("el-select",{staticClass:"info-content normal-input-style ",attrs:{placeholder:"请选择血型",clearable:""},model:{value:e.manInfo.blood_type,callback:function(t){e.$set(e.manInfo,"blood_type",t)},expression:"manInfo.blood_type"}},e._l(e.blood_select,function(e){return n("el-option",{key:e,attrs:{label:e,value:e}})}),1)],1),e._v(" "),n("div",{staticClass:"info-fill-panel leftpadding "},[n("el-row",{staticClass:"info-item-height-wrap-content border-bottom"},[n("span",{staticClass:"long-info-name"},[e._v("正在吃的药")]),e._v(" "),n("el-input",{staticClass:"long-info-content normal-input-style",attrs:{maxlength:"30",type:"textarea",autosize:"",placeholder:"预设内容",clearable:""},model:{value:e.manInfo.drugs,callback:function(t){e.$set(e.manInfo,"drugs",t)},expression:"manInfo.drugs"}})],1),e._v(" "),n("el-row",{staticClass:"info-item-height-wrap-content"},[n("span",{staticClass:"long-info-name"},[e._v("正在进行的治疗")]),e._v(" "),n("el-input",{staticClass:"long-info-content normal-input-style",attrs:{maxlength:"30",type:"textarea",autosize:"",placeholder:"预设内容",clearable:""},model:{value:e.manInfo.treatment,callback:function(t){e.$set(e.manInfo,"treatment",t)},expression:"manInfo.treatment"}})],1),e._v(" "),n("el-row",{staticClass:"info-item-height-wrap-content"},[n("span",{staticClass:"info-name"},[e._v("重要提醒")]),e._v(" "),n("el-input",{staticClass:"input-style-textarea",attrs:{type:"textarea",autosize:"",maxlength:"100",minline:"2",placeholder:"请填写一些比较紧急的注意事项"},model:{value:e.manInfo.message,callback:function(t){e.$set(e.manInfo,"message",t)},expression:"manInfo.message"}})],1)],1),e._v(" "),n("el-button",{staticClass:"wide-button",attrs:{type:"success"},on:{click:e.saveInfo}},[e._v("保存")]),e._v(" "),n("el-dialog",{attrs:{"lock-scroll":!1,visible:e.centerDialogVisible,title:"操作成功",width:"80%","show-close":!1,center:""},on:{"update:visible":function(t){e.centerDialogVisible=t}}},[n("span",{staticClass:"center-dialog-content"},[e._v("你的信息已经保存!")]),e._v(" "),n("span",{staticClass:"dialog-footer dialog-btn-group",attrs:{slot:"footer"},slot:"footer"},[n("span",{staticClass:"confirm-btn",attrs:{type:"primary"},on:{click:e.dialogConfirm}},[e._v("确定")])])])],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"item-title"},[t("span",{staticClass:"title-text"},[this._v("联系人号码填写")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"item-title border-bottom"},[t("span",{staticClass:"title-text"},[this._v("信息填写")])])}]};var d=n("VU/8")(c,m,!1,function(e){n("sqql")},"data-v-343ba1bc",null);t.default=d.exports},Xd32:function(e,t,n){n("+tPU"),n("zQR9"),e.exports=n("5PlU")},d7EF:function(e,t,n){"use strict";t.__esModule=!0;var a=s(n("us/S")),o=s(n("BO1k"));function s(e){return e&&e.__esModule?e:{default:e}}t.default=function(){return function(e,t){if(Array.isArray(e))return e;if((0,a.default)(Object(e)))return function(e,t){var n=[],a=!0,s=!1,l=void 0;try{for(var i,r=(0,o.default)(e);!(a=(i=r.next()).done)&&(n.push(i.value),!t||n.length!==t);a=!0);}catch(e){s=!0,l=e}finally{try{!a&&r.return&&r.return()}finally{if(s)throw l}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}()},fxRn:function(e,t,n){n("+tPU"),n("zQR9"),e.exports=n("g8Ux")},g8Ux:function(e,t,n){var a=n("77Pl"),o=n("3fs2");e.exports=n("FeBl").getIterator=function(e){var t=o(e);if("function"!=typeof t)throw TypeError(e+" is not iterable!");return a(t.call(e))}},sqql:function(e,t){},"us/S":function(e,t,n){e.exports={default:n("Xd32"),__esModule:!0}}});
//# sourceMappingURL=1.e7eaa527db17d2e59747.js.map